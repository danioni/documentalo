---
title: Email con Resend
description: Integraci√≥n de email transaccional v√≠a Resend en Coordinalo
---

# Email con Resend

Coordinalo utiliza [Resend](https://resend.com) para enviar emails transaccionales como recordatorios, confirmaciones, recibos y campa√±as de marketing.

## Requisitos previos

- Cuenta de Resend
- API Key de Resend
- Dominio verificado en Resend

## Configuraci√≥n inicial

### Configurar API Key

La API Key se configura como variable de entorno:

```bash
RESEND_API_KEY=re_xxxxxxxxxxxxx
```

### Verificar configuraci√≥n

```bash
GET /api/v1/organization/email/status
```

### Respuesta

```json
{
  "status": "active",
  "provider": "resend",
  "fromEmail": "notificaciones@micentro.com",
  "fromName": "Centro de Kinesiolog√≠a",
  "replyTo": "contacto@micentro.com",
  "domain": "micentro.com",
  "domainStatus": "verified",
  "stats": {
    "sentToday": 125,
    "deliveredToday": 122,
    "bouncedToday": 2,
    "openRateToday": 68.5
  }
}
```

### Actualizar configuraci√≥n de email

```bash
PUT /api/v1/organization/email/settings
```

### Body

```json
{
  "fromEmail": "notificaciones@micentro.com",
  "fromName": "Centro de Kinesiolog√≠a",
  "replyTo": "contacto@micentro.com",
  "footer": "Centro de Kinesiolog√≠a | Av. Principal 123, Santiago | +56 2 1234 5678"
}
```

## Templates de email

### Templates predefinidos

Coordinalo incluye los siguientes templates:

| Template | C√≥digo | Descripci√≥n |
|----------|--------|-------------|
| Confirmaci√≥n de sesi√≥n | `session_confirmation` | Confirma agendamiento |
| Recordatorio de sesi√≥n | `session_reminder` | Recuerda sesi√≥n pr√≥xima |
| Recibo de pago | `payment_receipt` | Comprobante de pago |
| Recordatorio de pago | `payment_reminder` | Aviso de pago pendiente |
| Bienvenida | `welcome_client` | Onboarding de cliente |
| Campa√±a | `campaign` | Template para campa√±as |
| Reseteo de contrase√±a | `password_reset` | Recuperar acceso |

### Listar templates

```bash
GET /api/v1/organization/email/templates
```

### Respuesta

```json
{
  "templates": [
    {
      "id": "session_confirmation",
      "name": "Confirmaci√≥n de sesi√≥n",
      "subject": "Tu sesi√≥n de {{service}} est√° confirmada",
      "category": "transactional",
      "variables": ["name", "service", "date", "time", "provider", "location"],
      "lastModified": "2026-01-15T10:00:00Z"
    },
    {
      "id": "session_reminder",
      "name": "Recordatorio de sesi√≥n",
      "subject": "Recordatorio: {{service}} ma√±ana a las {{time}}",
      "category": "reminder",
      "variables": ["name", "service", "date", "time", "provider"],
      "lastModified": "2026-01-10T14:00:00Z"
    },
    {
      "id": "payment_receipt",
      "name": "Recibo de pago",
      "subject": "Recibo de pago #{{receiptNumber}}",
      "category": "transactional",
      "variables": ["name", "receiptNumber", "amount", "description", "date"],
      "lastModified": "2026-01-05T09:00:00Z"
    }
  ]
}
```

### Ver template espec√≠fico

```bash
GET /api/v1/organization/email/templates/:templateId
```

### Respuesta

```json
{
  "id": "session_reminder",
  "name": "Recordatorio de sesi√≥n",
  "subject": "Recordatorio: {{service}} ma√±ana a las {{time}}",
  "body": "Hola {{name}},\n\nTe recordamos que tienes una sesi√≥n de {{service}} programada para:\n\nüìÖ Fecha: {{date}}\n‚è∞ Hora: {{time}}\nüë§ Profesional: {{provider}}\nüìç Lugar: {{location}}\n\nSi necesitas cancelar o reprogramar, por favor hazlo con al menos 24 horas de anticipaci√≥n.\n\n¬°Te esperamos!\n\nSaludos,\n{{organizationName}}",
  "html": "<!DOCTYPE html><html>...",
  "variables": ["name", "service", "date", "time", "provider", "location", "organizationName"],
  "category": "reminder",
  "previewText": "No olvides tu sesi√≥n de {{service}}",
  "createdAt": "2025-06-01T10:00:00Z",
  "lastModified": "2026-01-10T14:00:00Z"
}
```

### Personalizar template

```bash
PUT /api/v1/organization/email/templates/:templateId
```

### Body

```json
{
  "subject": "‚è∞ Recordatorio: Tu sesi√≥n de {{service}}",
  "body": "Hola {{name}},\n\nMa√±ana tienes tu sesi√≥n de {{service}} a las {{time}}.\n\nTe esperamos en {{location}}.\n\n{{organizationName}}",
  "previewText": "Tu sesi√≥n de {{service}} es ma√±ana"
}
```

### Crear template personalizado

```bash
POST /api/v1/organization/email/templates
```

### Body

```json
{
  "id": "birthday_greeting",
  "name": "Felicitaci√≥n de cumplea√±os",
  "subject": "üéÇ ¬°Feliz cumplea√±os, {{name}}!",
  "body": "Querido/a {{name}},\n\n¬°Todo el equipo de {{organizationName}} te desea un muy feliz cumplea√±os!\n\nComo regalo, te ofrecemos un {{discount}}% de descuento en tu pr√≥xima sesi√≥n.\n\nUsa el c√≥digo: {{promoCode}}\n\nV√°lido hasta: {{expirationDate}}\n\n¬°Que tengas un excelente d√≠a!",
  "category": "marketing",
  "variables": ["name", "organizationName", "discount", "promoCode", "expirationDate"]
}
```

## Enviar email

### Enviar email directo

```bash
POST /api/v1/clients/:clientId/send-email
```

### Body

```json
{
  "template": "session_reminder",
  "variables": {
    "service": "kinesiolog√≠a",
    "date": "21 de enero de 2026",
    "time": "10:00",
    "provider": "Mar√≠a Gonz√°lez",
    "location": "Av. Principal 123, Santiago"
  }
}
```

### Respuesta exitosa (200)

```json
{
  "id": "email_abc123",
  "clientId": "cli_001",
  "to": "juan@example.com",
  "subject": "Recordatorio: kinesiolog√≠a ma√±ana a las 10:00",
  "template": "session_reminder",
  "status": "sent",
  "sentAt": "2026-01-20T08:00:00Z",
  "resendId": "re_xyz789"
}
```

### Enviar email con contenido personalizado

```bash
POST /api/v1/clients/:clientId/send-email
```

### Body

```json
{
  "subject": "Informaci√≥n importante",
  "body": "Hola Juan,\n\nQuer√≠amos informarte que...",
  "replyTo": "doctor@micentro.com"
}
```

## Preview de email

### Generar preview

```bash
POST /api/v1/organization/email/templates/:templateId/preview
```

### Body

```json
{
  "clientId": "cli_001",
  "variables": {
    "service": "kinesiolog√≠a",
    "date": "21 de enero de 2026",
    "time": "10:00"
  }
}
```

### Respuesta

```json
{
  "subject": "Recordatorio: kinesiolog√≠a ma√±ana a las 10:00",
  "body": "Hola Juan,\n\nTe recordamos que tienes una sesi√≥n de kinesiolog√≠a programada para:\n\nüìÖ Fecha: 21 de enero de 2026\n‚è∞ Hora: 10:00\n...",
  "html": "<!DOCTYPE html><html>...",
  "previewText": "No olvides tu sesi√≥n de kinesiolog√≠a"
}
```

### Enviar email de prueba

```bash
POST /api/v1/organization/email/templates/:templateId/test
```

### Body

```json
{
  "to": "test@micentro.com",
  "variables": {
    "name": "Usuario de Prueba",
    "service": "kinesiolog√≠a",
    "date": "21 de enero de 2026",
    "time": "10:00"
  }
}
```

## Webhooks de Resend

Coordinalo recibe webhooks de Resend para rastrear el estado de los emails.

### Eventos soportados

| Evento | Descripci√≥n |
|--------|-------------|
| `email.sent` | Email enviado a Resend |
| `email.delivered` | Email entregado al servidor destino |
| `email.opened` | Email abierto por el destinatario |
| `email.clicked` | Click en enlace del email |
| `email.bounced` | Email rebotado |
| `email.complained` | Marcado como spam |

### Configurar webhook en Resend

```bash
GET /api/v1/organization/email/webhook-config
```

```json
{
  "webhookUrl": "https://api.coordinalo.com/webhooks/resend/org_abc123",
  "secret": "whsec_xyz789",
  "events": [
    "email.delivered",
    "email.opened",
    "email.clicked",
    "email.bounced",
    "email.complained"
  ]
}
```

### Ejemplo de webhook recibido

```json
{
  "type": "email.opened",
  "data": {
    "email_id": "re_xyz789",
    "to": ["juan@example.com"],
    "subject": "Recordatorio: kinesiolog√≠a ma√±ana a las 10:00",
    "opened_at": "2026-01-20T09:15:00Z"
  }
}
```

## Gesti√≥n de rebotes

### Ver emails rebotados

```bash
GET /api/v1/organization/email/bounces
```

### Respuesta

```json
{
  "data": [
    {
      "id": "bounce_001",
      "clientId": "cli_002",
      "clientName": "Ana L√≥pez",
      "email": "ana@invalid-domain.com",
      "bounceType": "hard",
      "reason": "Mailbox does not exist",
      "bouncedAt": "2026-01-15T10:00:10Z",
      "originalEmailId": "email_def456"
    }
  ],
  "summary": {
    "hardBounces": 15,
    "softBounces": 8,
    "last30Days": 23
  }
}
```

### Tipos de rebote

| Tipo | C√≥digo | Descripci√≥n | Acci√≥n |
|------|--------|-------------|--------|
| Hard bounce | `hard` | Email no existe | Marcar como inv√°lido |
| Soft bounce | `soft` | Buz√≥n lleno, temporal | Reintentar |
| Spam complaint | `complaint` | Marcado como spam | Desuscribir |

### Limpiar emails inv√°lidos

```bash
POST /api/v1/organization/email/clean-bounces
```

```json
{
  "action": "mark_invalid",
  "bounceIds": ["bounce_001", "bounce_002"]
}
```

## Lista de supresi√≥n

### Ver lista de supresi√≥n

```bash
GET /api/v1/organization/email/suppression-list
```

### Respuesta

```json
{
  "data": [
    {
      "email": "unsubscribed@example.com",
      "reason": "unsubscribed",
      "addedAt": "2026-01-10T14:00:00Z"
    },
    {
      "email": "bounced@invalid.com",
      "reason": "hard_bounce",
      "addedAt": "2026-01-15T10:00:10Z"
    }
  ]
}
```

### Agregar a lista de supresi√≥n

```bash
POST /api/v1/organization/email/suppression-list
```

```json
{
  "email": "noemail@example.com",
  "reason": "manual"
}
```

## Estad√≠sticas

### Obtener estad√≠sticas de email

```bash
GET /api/v1/organization/email/stats
```

### Par√°metros de query

| Par√°metro | Tipo | Descripci√≥n |
|-----------|------|-------------|
| `from` | `string` | Fecha inicio |
| `to` | `string` | Fecha fin |
| `groupBy` | `string` | `day`, `week`, `month` |

### Respuesta

```json
{
  "period": {
    "from": "2026-01-01",
    "to": "2026-01-31"
  },
  "totals": {
    "sent": 1500,
    "delivered": 1425,
    "opened": 1100,
    "clicked": 280,
    "bounced": 50,
    "complained": 5
  },
  "rates": {
    "deliveryRate": 95.0,
    "openRate": 77.2,
    "clickRate": 19.6,
    "bounceRate": 3.3,
    "complaintRate": 0.3
  },
  "byTemplate": {
    "session_reminder": {
      "sent": 600,
      "openRate": 82.5
    },
    "payment_receipt": {
      "sent": 400,
      "openRate": 75.0
    }
  }
}
```